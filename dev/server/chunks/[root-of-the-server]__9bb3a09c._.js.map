{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///workspaces/foodcombocalc/app/api/lists/%5Bname%5D/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport fs from \"fs/promises\";\nimport path from \"path\";\n\nconst LISTS_DIR = path.resolve(process.cwd(), \"lists\");\nconst ORDER_FILE = path.join(LISTS_DIR, \"_order.json\");\n\nexport async function GET(req: Request) {\n  const url = new URL(req.url);\n  const parts = url.pathname.split(\"/\").filter(Boolean);\n  const name = decodeURIComponent(parts[parts.length - 1] || \"\");\n  const full = path.join(LISTS_DIR, name);\n  try {\n    const content = await fs.readFile(full, \"utf-8\");\n    if (url.searchParams.get(\"download\")) {\n      return new NextResponse(content, {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"Content-Disposition\": `attachment; filename=\"${name}\"`,\n        },\n      });\n    }\n    return NextResponse.json(JSON.parse(content));\n  } catch (e) {\n    return new NextResponse(JSON.stringify({ error: \"Not found\" }), { status: 404 });\n  }\n}\n\nexport async function DELETE(req: Request) {\n  const url = new URL(req.url);\n  const parts = url.pathname.split(\"/\").filter(Boolean);\n  const name = decodeURIComponent(parts[parts.length - 1] || \"\");\n  const full = path.join(LISTS_DIR, name);\n  try {\n    await fs.unlink(full);\n    try {\n      const txt = await fs.readFile(ORDER_FILE, 'utf-8').catch(() => '[]');\n      const order = JSON.parse(txt || '[]');\n      const next = (order || []).filter((f: string) => f !== name);\n      await fs.writeFile(ORDER_FILE, JSON.stringify(next, null, 2), 'utf-8');\n    } catch (e) {}\n    return NextResponse.json({ ok: true });\n  } catch (e) {\n    return new NextResponse(JSON.stringify({ error: \"Not found\" }), { status: 404 });\n  }\n}\n\nexport async function PUT(req: Request) {\n  const url = new URL(req.url);\n  const parts = url.pathname.split(\"/\").filter(Boolean);\n  const name = decodeURIComponent(parts[parts.length - 1] || \"\");\n  const full = path.join(LISTS_DIR, name);\n  const body = await req.json().catch(() => ({} as any));\n  const { content, newName } = body as { content?: any; newName?: string };\n  try {\n    if (content) {\n      await fs.writeFile(full, JSON.stringify(content, null, 2), \"utf-8\");\n    }\n    if (newName) {\n      const dest = path.join(LISTS_DIR, newName);\n      try {\n        await fs.access(dest);\n        return new NextResponse(JSON.stringify({ error: \"Target already exists\" }), { status: 409 });\n      } catch (e) {\n      }\n      await fs.rename(full, dest);\n      try {\n        const txt = await fs.readFile(ORDER_FILE, 'utf-8').catch(() => '[]');\n        const order = JSON.parse(txt || '[]');\n        const next = (order || []).map((f: string) => f === name ? newName : f);\n        await fs.writeFile(ORDER_FILE, JSON.stringify(next, null, 2), 'utf-8');\n      } catch (e) {}\n      return NextResponse.json({ filename: newName });\n    }\n    return NextResponse.json({ ok: true });\n  } catch (e) {\n    return new NextResponse(JSON.stringify({ error: \"Failed\" }), { status: 500 });\n  }\n}"],"names":[],"mappings":"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"}}]
}